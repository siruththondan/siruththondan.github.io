function copySwara(e){const n=e.closest(".swara-block"),t=[];n.querySelectorAll(".swara-line").forEach(e=>{const n=e.querySelector(".swara-content");if(n){const e=Array.from(n.querySelectorAll(".swara-cell")).map(e=>e.innerText.trim()).filter(Boolean);e.length>0&&t.push(e.join(" "))}});const s=t.join(`
`);navigator.clipboard.writeText(s).then(()=>{e.classList.add("copied"),e.innerText="Copied âœ“",setTimeout(()=>{e.classList.remove("copied"),e.innerText="Copy"},2e3)})}document.addEventListener("DOMContentLoaded",function(){function e(e){let n=0,s=0;for(;e.startsWith(".");)n++,e=e.substring(1);for(;e.endsWith("'");)s++,e=e.slice(0,-1);const t=document.createElement("span");return t.className="swara-cell",n===1&&t.classList.add("mandra"),n>=2&&t.classList.add("anumandra"),s===1&&t.classList.add("tara"),s>=2&&t.classList.add("atitara"),t.innerText=e,t}function t(e){const s=e.dataset.mode;if(s==="custom"){const t=parseInt(e.dataset.groups),n=parseInt(e.dataset.perGroup);return!t||!n?[]:Array(t).fill(n)}const o={Thisra:3,Chatusra:4,Khanda:5,Misra:7,Sankeerna:9},i={Dhruva:["laghu","dhrutam","laghu","laghu"],Matya:["laghu","dhrutam","laghu"],Rupaka:["dhrutam","laghu"],Jhampa:["laghu","anudhrutam","dhrutam"],Triputa:["laghu","dhrutam","dhrutam"],Ata:["laghu","laghu","dhrutam","dhrutam"],Eka:["laghu"]},t=i[e.dataset.thalam],n=o[e.dataset.jaathi];return!t||!n?[]:t.map(e=>{if(e==="laghu")return n;if(e==="dhrutam")return 2;if(e==="anudhrutam")return 1})}document.querySelectorAll(".swara-block").forEach(n=>{let o=1;const s=t(n),i=n.dataset.doubleBar==="true";n.querySelectorAll(".swara-line").forEach(t=>{let n=t.querySelector(".line-number");n||(n=document.createElement("div"),n.className="line-number",t.insertBefore(n,t.firstChild)),n.innerText=o++;const a=t.querySelector(".swara-content"),d=a.innerText.trim(),r=d.split(/\s+/).filter(Boolean);a.innerHTML="";let c=0;s.forEach((t,n)=>{const d=n===s.length-1,l=document.createElement("span");l.className="anga-group";for(let n=0;n<t&&c<r.length;n++)l.appendChild(e(r[c++]));a.appendChild(l);const o=document.createElement("span");d&&i?(o.innerText="||",o.className="tala-double"):(o.innerText="|",o.className="tala-single"),a.appendChild(o)});const l=s.reduce((e,t)=>e+t,0);if(r.length!==l){t.classList.add("swara-error");const e=t.querySelector(".swara-warning");e&&(e.innerText=`Expected ${l} swaras, found ${r.length}`)}})});function n(e){const n=window.getComputedStyle(e),s=parseFloat(n.lineHeight),o=s*2;let t=parseFloat(n.fontSize);const i=11;for(;e.scrollHeight>o+4&&t>i;)t-=.5,e.style.fontSize=t+"px"}})